/*!
* suggestify-engine v1.3.5
* (c) 2021 Max van der Schee
* @license MIT
*/
"use strict";module.exports=class{input;defaultItems;sortedItems;items;config;char;globalReg;constructor({defaultItems:t,sortedItems:s,options:e}){this.defaultItems=t,this.sortedItems=s,this.config={MIN_DISTANCE:3|e.MIN_DISTANCE,ITEM_CAP:8|e.ITEM_CAP,ITEM_CAP_ALT:4*e.ITEM_CAP|32}}async getResults(t){return this.input=t,this.globalReg=new RegExp(t.replace(/\W+/g,"|"),"i"),this.char=t.charAt(0),this.items=this.sortedItems[this.char]?this.sortedItems[this.char]:[],this.listFilter()}listFilter(){const t={match:[],alt:[]},s=s=>{this.globalReg.test(s)&&t.match.push(s)},e=s=>{this.levenshtein(s,this.input)<=this.config.MIN_DISTANCE&&t.alt.push(s)},i=()=>t.match.length>=this.config.ITEM_CAP,h=()=>t.alt.length>=this.config.ITEM_CAP_ALT;for(let t=0;t<this.items.length&&(s(this.items[t]),e(this.items[t]),!i()&&!h());t++);if(!i()&&!h()){const t=this.defaultItems.length;for(let l=0;l<t&&(s(this.defaultItems[l]),e(this.defaultItems[l]),!i()&&!h());l++);}return[...new Set([...this.sortResults(this.input,t.match),...this.sortResults(this.input,t.alt)])].slice(0,this.config.ITEM_CAP)}sortResults(t,s){return s.sort(((s,e)=>{const i=this.levenshtein(t,s),h=this.levenshtein(t,e);return i>h?1:i<h?-1:0}))}levenshtein(t,s){if(!t.length)return s.length;if(!s.length)return t.length;const e=s.length,i=t.length,h=[];for(let l=0;l<=e;l++){h[l]=[l];for(let e=1;e<=i;e++)h[l][e]=0===l?e:Math.min(h[l-1][e]+1,h[l][e-1]+1,h[l-1][e-1]+(t[e-1]===s[l-1]?0:1))}return h[e][i]}};
