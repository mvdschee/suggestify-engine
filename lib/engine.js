/*!
* suggestify-engine v1.3.4
* (c) 2021 Max van der Schee
* @license MIT
*/
"use strict";module.exports=class{input;defaultItems;sortedItems;items;config;char;globalReg;constructor({defaultItems:t,sortedItems:s,options:e}){this.defaultItems=t,this.sortedItems=s,this.config={MIN_DISTANCE:3|e.MIN_DISTANCE,ITEM_CAP:8|e.ITEM_CAP,ITEM_CAP_ALT:4*e.ITEM_CAP|32}}async getResults(t){return this.input=t,this.globalReg=new RegExp(t.replace(/\W+/g,"|"),"i"),this.char=t.charAt(0),this.items=this.sortedItems[this.char]?this.sortedItems[this.char]:[],this.listFilter()}listFilter(){const t={match:[],alt:[]},s=s=>{this.globalReg.test(s)&&t.match.push(s)},e=s=>{this.levenshtein(s,this.input)<=this.config.MIN_DISTANCE&&t.alt.push(s)},i=()=>t.match.length>=this.config.ITEM_CAP,h=()=>t.alt.length>=this.config.ITEM_CAP_ALT;for(let t=0;t<this.items.length&&(s(this.items[t]),e(this.items[t]),!i()&&!h());t++);if(!i()&&!h())for(let t=0;t<this.defaultItems.length&&(s(this.defaultItems[t]),e(this.defaultItems[t]),!i()&&!h());t++);return[...new Set([...this.sortResults(this.input,t.match),...this.sortResults(this.input,t.alt)])].slice(0,this.config.ITEM_CAP)}sortResults(t,s){return s.sort(((s,e)=>{const i=this.levenshtein(t,s),h=this.levenshtein(t,e);return i>h?1:i<h?-1:0}))}levenshtein(t,s){if(!t.length)return s.length;if(!s.length)return t.length;const e=[];for(let i=0;i<=s.length;i++){e[i]=[i];for(let h=1;h<=t.length;h++)e[i][h]=0===i?h:Math.min(e[i-1][h]+1,e[i][h-1]+1,e[i-1][h-1]+(t[h-1]===s[i-1]?0:1))}return e[s.length][t.length]}};
